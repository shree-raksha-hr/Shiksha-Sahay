

<div class="container my-4">
    <div class="row">
        <div class="col-12">
            <h2>Learning Materials</h2>
            <p class="text-muted">Explore text, video, and audio materials organized by subject and grade</p>
        </div>
    </div>
    
    <!-- Filter Section -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="GET" action="/materials" class="row g-3">
                <div class="col-md-3">
                    <label for="subject" class="form-label">Subject</label>
                    <select class="form-control" id="subject" name="subject">
                        <option value="">All Subjects</option>
                        <% subjects.forEach(subject => { %>
                            <option value="<%= subject %>" <%= filters.subject === subject ? 'selected' : '' %>>
                                <%= subject %>
                            </option>
                        <% }) %>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="grade" class="form-label">Grade</label>
                    <select class="form-control" id="grade" name="grade">
                        <option value="">All Grades</option>
                        <% grades.forEach(grade => { %>
                            <option value="<%= grade %>" <%= filters.grade == grade ? 'selected' : '' %>>
                                Grade <%= grade %>
                            </option>
                        <% }) %>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="type" class="form-label">Type</label>
                    <select class="form-control" id="type" name="type">
                        <option value="">All Types</option>
                        <% types.forEach(type => { %>
                            <option value="<%= type %>" <%= filters.type === type ? 'selected' : '' %>>
                                <%= type.charAt(0).toUpperCase() + type.slice(1) %>
                            </option>
                        <% }) %>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">&nbsp;</label>
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">Filter</button>
                        <a href="/materials" class="btn btn-outline-secondary">Clear</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <% if (materials.length > 0) { %>
        <div class="row">
            <% materials.forEach(material => { %>
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 material-card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h6 class="mb-0"><%= material.title %></h6>
                            <span class="badge bg-<%= material.type === 'video' ? 'info' : material.type === 'audio' ? 'warning' : 'success' %>">
                                <i class="fas fa-<%= material.type === 'video' ? 'play' : material.type === 'audio' ? 'volume-up' : 'file-text' %> me-1"></i>
                                <%= material.type.charAt(0).toUpperCase() + material.type.slice(1) %>
                            </span>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><%= material.description.substring(0, 100) %>...</p>
                            <p class="small text-muted">
                                <strong>Subject:</strong> <%= material.subject %><br>
                                <strong>Grade:</strong> <%= material.grade %><br>
                                <strong>Uploaded by:</strong> <%= material.uploadedBy.name %>
                            </p>
                            <% if (material.tags && material.tags.length > 0) { %>
                                <div class="mb-2">
                                    <% material.tags.forEach(tag => { %>
                                        <span class="badge bg-light text-dark me-1"><%= tag %></span>
                                    <% }) %>
                                </div>
                            <% } %>
                        </div>
                        <div class="card-footer">
                            <a href="/materials/view/<%= material._id %>" class="btn btn-primary btn-sm">
                                <i class="fas fa-eye me-1"></i>View Material
                            </a>
                        </div>
                    </div>
                </div>
            <% }) %>
        </div>
    <% } else { %>
        <div class="text-center">
            <i class="fas fa-book-open fa-5x text-muted mb-3"></i>
            <h4>No Materials Found</h4>
            <p class="text-muted">
                No materials match your current filters. Try adjusting your search criteria.
            </p>
        </div>
    <% } %>
</div>